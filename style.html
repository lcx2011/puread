<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>PureRead</title>
    <style>
        /* --- 全局重置与变量 --- */
        :root {
            --ios-bg: #F2F2F7;
            --ios-card: #FFFFFF;
            --ios-blue: #007AFF;
            --ios-text: #000000;
            --ios-gray: #8E8E93;
            --ios-separator: rgba(60, 60, 67, 0.29);
            --reader-bg: #FAF9F6; /* 默认米白 */
            --reader-text: #333333;
            --font-interface: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
            --font-reader: "Songti SC", "Noto Serif SC", "Times New Roman", serif;
            --safe-area-top: env(safe-area-inset-top);
            --safe-area-bottom: env(safe-area-inset-bottom);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; font-family: var(--font-interface); background-color: var(--ios-bg); color: var(--ios-text); }

        /* --- 图标 (使用纯CSS绘制简单图标以减少依赖) --- */
        .icon { width: 24px; height: 24px; display: inline-block; background-size: contain; background-repeat: no-repeat; background-position: center; }
        .icon-plus { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23007AFF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='12' y1='5' x2='12' y2='19'%3E%3C/line%3E%3Cline x1='5' y1='12' x2='19' y2='12'%3E%3C/line%3E%3C/svg%3E"); }
        .icon-back { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23007AFF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='15 18 9 12 15 6'%3E%3C/polyline%3E%3C/svg%3E"); }
        .icon-list { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='8' y1='6' x2='21' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='12' x2='21' y2='12'%3E%3C/line%3E%3Cline x1='8' y1='18' x2='21' y2='18'%3E%3C/line%3E%3Cline x1='3' y1='6' x2='3.01' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='12' x2='3.01' y2='12'%3E%3C/line%3E%3Cline x1='3' y1='18' x2='3.01' y2='18'%3E%3C/line%3E%3C/svg%3E"); }
        .icon-aa { font-weight: bold; font-size: 18px; text-align: center; line-height: 24px; }

        /* --- 视图切换 --- */
        .view { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow-y: auto; transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1); background: var(--ios-bg); }
        .view.hidden { transform: translateX(100%); pointer-events: none; z-index: 10; }
        .view.active { transform: translateX(0); z-index: 20; }
        
        /* --- 主界面: 书架 --- */
        #library-view { padding: calc(var(--safe-area-top) + 60px) 20px 20px; }
        
        .nav-bar {
            position: fixed; top: 0; left: 0; width: 100%; height: calc(var(--safe-area-top) + 44px);
            display: flex; justify-content: space-between; align-items: flex-end;
            padding: 0 16px 10px; z-index: 100;
            background: rgba(242, 242, 247, 0.8);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 0.5px solid rgba(0,0,0,0.0); /* 滚动时可变为可见 */
            transition: border-color 0.3s;
        }
        .nav-title { font-size: 17px; font-weight: 600; opacity: 0; transition: opacity 0.2s; }
        .nav-actions { display: flex; gap: 15px; }

        .large-header { margin-bottom: 20px; }
        .large-title { font-size: 34px; font-weight: 700; letter-spacing: 0.3px; color: #000; }

        /* 书架网格 */
        .book-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px 15px; /* 行间距大一点 */
            padding-bottom: 40px;
        }

        .book-item {
            display: flex; flex-direction: column; align-items: center;
            animation: fadeIn 0.5s ease-out;
        }

        .book-cover {
            width: 100%; aspect-ratio: 2 / 3;
            background: #ddd;
            border-radius: 6px; /* iOS 风格通常不用特别大的圆角用于书本 */
            box-shadow: 0 4px 10px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.1);
            position: relative; overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        
        .book-cover:active { transform: scale(0.96); box-shadow: 0 2px 6px rgba(0,0,0,0.1); }

        /* 模拟封面图案 (CSS生成) */
        .cover-art { width: 100%; height: 100%; background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); display: flex; align-items: center; justify-content: center; padding: 10px; text-align: center; font-size: 10px; font-weight: bold; color: rgba(0,0,0,0.5); line-height: 1.2; }
        .c2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        .c3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .c4 { background: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%); }

        /* --- 阅读界面 --- */
        #reader-view { background-color: var(--reader-bg); overflow: hidden; /* 内部滚动 */ }

        #reader-content {
            height: 100%; width: 100%;
            overflow-y: scroll;
            padding: calc(var(--safe-area-top) + 50px) 24px calc(var(--safe-area-bottom) + 80px);
            font-family: var(--font-reader);
            font-size: 19px;
            line-height: 1.7;
            text-align: justify;
            color: var(--reader-text);
            -webkit-overflow-scrolling: touch;
        }

        #reader-content p { margin-bottom: 1.2em; text-indent: 2em; }

        /* 阅读器菜单 (HUD) */
        .hud {
            position: fixed; left: 0; width: 100%;
            background: rgba(250, 249, 246, 0.95); /* 跟随阅读背景 */
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), opacity 0.3s;
            z-index: 200;
            border-color: rgba(0,0,0,0.05);
            border-style: solid;
        }
        
        /* HUD 隐藏状态 */
        .hud-hidden .hud-top { transform: translateY(-100%); opacity: 0; }
        .hud-hidden .hud-bottom { transform: translateY(100%); opacity: 0; }

        .hud-top {
            top: 0; border-bottom-width: 0.5px;
            height: calc(var(--safe-area-top) + 44px);
            padding-top: var(--safe-area-top);
            display: flex; align-items: center;
            padding-left: 10px;
        }

        .hud-bottom {
            bottom: 0; border-top-width: 0.5px;
            padding: 20px 20px calc(var(--safe-area-bottom) + 20px);
            display: flex; flex-direction: column; gap: 20px;
        }

        .hud-btn { background: none; border: none; color: var(--ios-blue); font-size: 16px; display: flex; align-items: center; gap: 5px; cursor: pointer; }

        /* 进度条区域 */
        .progress-area { display: flex; align-items: center; gap: 15px; color: var(--ios-gray); font-size: 12px; }
        .slider-container { flex: 1; position: relative; height: 20px; display: flex; align-items: center; }
        .slider-track { width: 100%; height: 3px; background: #e5e5e5; border-radius: 2px; }
        .slider-fill { width: 30%; height: 3px; background: var(--ios-gray); border-radius: 2px; }
        .slider-thumb { 
            position: absolute; left: 30%; width: 18px; height: 18px; 
            background: #fff; border-radius: 50%; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); border: 0.5px solid rgba(0,0,0,0.1);
            transform: translateX(-50%);
        }

        /* 底部操作栏 */
        .toolbar { display: flex; justify-content: space-between; align-items: center; padding: 0 10px; }

        /* 设置面板 (AA) */
        .settings-panel {
            height: 0; overflow: hidden; transition: height 0.3s ease; opacity: 0;
        }
        .settings-panel.open { height: 100px; opacity: 1; margin-top: 10px; }
        
        .theme-options { display: flex; justify-content: center; gap: 20px; margin-top: 15px; }
        .theme-dot { width: 36px; height: 36px; border-radius: 50%; border: 1px solid rgba(0,0,0,0.1); cursor: pointer; position: relative; }
        .theme-dot.active::after {
            content: ''; position: absolute; top: -4px; left: -4px; right: -4px; bottom: -4px;
            border: 2px solid var(--ios-blue); border-radius: 50%;
        }
        .theme-white { background: #FAF9F6; }
        .theme-sepia { background: #F5E6D0; }
        .theme-dark { background: #1c1c1e; border: none; }

        /* 动画关键帧 */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <!-- === 主界面: 书架 === -->
    <div id="library-view" class="view active">
        <!-- 顶部导航 (模拟iOS) -->
        <div class="nav-bar" id="lib-nav">
            <div class="nav-actions"></div> <!-- 占位 -->
            <div class="nav-title">书架</div>
            <div class="nav-actions">
                <div class="icon icon-plus"></div>
            </div>
        </div>

        <!-- 大标题 -->
        <div class="large-header">
            <div class="large-title">书架</div>
        </div>

        <!-- 书籍列表 -->
        <div class="book-grid" id="book-grid">
            <!-- JS 将生成书籍 -->
        </div>
    </div>

    <!-- === 阅读界面 === -->
    <div id="reader-view" class="view hidden hud-hidden">
        <!-- 顶部菜单 -->
        <div class="hud hud-top">
            <button class="hud-btn" onclick="closeBook()">
                <div class="icon icon-back"></div>
                书架
            </button>
        </div>

        <!-- 文本内容区域 -->
        <div id="reader-content" onclick="toggleHud()">
            <!-- 正文 -->
            <h3>第一章 这里的黎明静悄悄</h3>
            <p>长夜将至，我从今开始守望，至死方休。我将不娶妻、不封地、不生子。我将不戴宝冠，不争荣宠。我将尽忠职守，生死於斯。我是黑暗中的利剑，长城上的守卫。</p>
            <p>我是抵御寒冷的烈焰，破晓时分的光线，唤醒眠者的号角，守护王国的坚盾。我将生命与荣耀献给守夜人，今夜如此，夜夜皆然。</p>
            <p>风在窗外呼啸，仿佛某种古老巨兽的低语。房间里烛火摇曳，映照在陈旧的羊皮纸上。他放下羽毛笔，揉了揉酸痛的眉心，眼神中流露出一丝不易察觉的疲惫。</p>
            <p>设计原则之一：清晰。在整个系统中，文字在任何尺寸下都必须清晰易读，图标必须精准易懂，修饰必须恰到好处且与功能密切相关。</p>
            <p>设计原则之二：纵深感。视觉层级和逼真的动态效果赋予界面活力，并加深用户对层级关系的理解。</p>
            <p>这里是模拟的长段落文字。为了测试阅读器的排版效果，我们需要足够多的文字来填充屏幕。iOS 的阅读体验强调沉浸感，因此在阅读模式下，除了文字，不应该有任何干扰元素。</p>
            <p>当你点击屏幕中央时，工具栏会优雅地浮现。当你再次点击或开始滚动时，它们又会悄然隐退。这种交互模式已经被亿万用户所习惯。</p>
            <p>继续填充文字... 手机阅读软件的排版要注意行间距，通常设置为 1.5 到 1.8 倍行高比较合适。两端对齐在移动端虽然整齐，但如果处理不好断字（Hyphenation）容易出现大片空白，中文环境通常直接左对齐或两端对齐均可。</p>
            <p>底部还需要留出足够的 Safe Area，避免手指在操作 Home Bar 时误触。</p>
            <br><br><br>
        </div>

        <!-- 底部菜单 -->
        <div class="hud hud-bottom">
            <!-- 进度条 -->
            <div class="progress-area">
                <span>上一章</span>
                <div class="slider-container">
                    <div class="slider-track"></div>
                    <div class="slider-fill"></div>
                    <div class="slider-thumb"></div>
                </div>
                <span>下一章</span>
            </div>

            <!-- 工具栏 -->
            <div class="toolbar">
                <div class="icon icon-list"></div> <!-- 目录 -->
                <div class="icon icon-aa" onclick="toggleSettings()">Aa</div> <!-- 设置 -->
            </div>

            <!-- 设置面板 (隐藏) -->
            <div class="settings-panel" id="settings-panel">
                <div style="text-align:center; font-size:12px; color:var(--ios-gray);">背景颜色</div>
                <div class="theme-options">
                    <div class="theme-dot theme-white active" onclick="setTheme('white', this)"></div>
                    <div class="theme-dot theme-sepia" onclick="setTheme('sepia', this)"></div>
                    <div class="theme-dot theme-dark" onclick="setTheme('dark', this)"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 模拟书籍数据 ---
        const books = [
            { title: "三体", class: "c2" },
            { title: "百年孤独", class: "c3" },
            { title: "失控", class: "c4" },
            { title: "设计心理学", class: "cover-art" },
            { title: "人类简史", class: "c2" },
            { title: "红楼梦", class: "c3" }
        ];

        // --- 初始化书架 ---
        const grid = document.getElementById('book-grid');
        books.forEach(book => {
            const item = document.createElement('div');
            item.className = 'book-item';
            item.innerHTML = `
                <div class="book-cover ${book.class}" onclick="openBook('${book.title}')">
                    <span>${book.title}</span>
                </div>
            `;
            grid.appendChild(item);
        });

        // --- 交互逻辑 ---
        const libView = document.getElementById('library-view');
        const readerView = document.getElementById('reader-view');
        const readerContent = document.getElementById('reader-content');
        const settingsPanel = document.getElementById('settings-panel');

        // 打开书籍
        function openBook(title) {
            // 简单的转场逻辑
            libView.classList.add('hidden');
            libView.classList.remove('active');
            
            readerView.classList.remove('hidden');
            readerView.classList.add('active');
            
            // 重置阅读器状态
            readerView.classList.add('hud-hidden');
            settingsPanel.classList.remove('open');
            readerContent.scrollTop = 0;
        }

        // 关闭书籍（返回）
        function closeBook() {
            readerView.classList.add('hidden');
            readerView.classList.remove('active');
            
            libView.classList.remove('hidden');
            libView.classList.add('active');
        }

        // 切换菜单显示/隐藏
        function toggleHud() {
            readerView.classList.toggle('hud-hidden');
            // 如果菜单隐藏了，设置面板也要收起
            if (readerView.classList.contains('hud-hidden')) {
                settingsPanel.classList.remove('open');
            }
        }

        // 切换设置面板
        function toggleSettings() {
            settingsPanel.classList.toggle('open');
        }

        // 书架滚动监听 (实现大标题变为导航栏标题的效果)
        libView.addEventListener('scroll', (e) => {
            const scrollY = e.target.scrollTop;
            const navTitle = document.querySelector('.nav-title');
            const navBar = document.querySelector('.nav-bar');
            
            if (scrollY > 40) {
                navTitle.style.opacity = 1;
                navBar.style.borderBottomColor = "var(--ios-separator)";
            } else {
                navTitle.style.opacity = 0;
                navBar.style.borderBottomColor = "rgba(0,0,0,0)";
            }
        });

        // 切换主题
        function setTheme(type, el) {
            // UI 更新
            document.querySelectorAll('.theme-dot').forEach(d => d.classList.remove('active'));
            el.classList.add('active');

            // 变量更新
            const r = document.querySelector(':root');
            if (type === 'white') {
                r.style.setProperty('--reader-bg', '#FAF9F6');
                r.style.setProperty('--reader-text', '#333333');
            } else if (type === 'sepia') {
                r.style.setProperty('--reader-bg', '#F5E6D0');
                r.style.setProperty('--reader-text', '#5F4B32');
            } else if (type === 'dark') {
                r.style.setProperty('--reader-bg', '#1c1c1e');
                r.style.setProperty('--reader-text', '#A1A1A1');
            }
        }
    </script>
</body>
</html>